[2021-06-20 09:22:09,013] {taskinstance.py:876} INFO - Dependencies all met for <TaskInstance: orion.getInfoFromFiware 2021-06-20T09:22:08.084474+00:00 [queued]>
[2021-06-20 09:22:09,035] {taskinstance.py:876} INFO - Dependencies all met for <TaskInstance: orion.getInfoFromFiware 2021-06-20T09:22:08.084474+00:00 [queued]>
[2021-06-20 09:22:09,036] {taskinstance.py:1067} INFO - 
--------------------------------------------------------------------------------
[2021-06-20 09:22:09,037] {taskinstance.py:1068} INFO - Starting attempt 1 of 1
[2021-06-20 09:22:09,042] {taskinstance.py:1069} INFO - 
--------------------------------------------------------------------------------
[2021-06-20 09:22:09,054] {taskinstance.py:1087} INFO - Executing <Task(PythonOperator): getInfoFromFiware> on 2021-06-20T09:22:08.084474+00:00
[2021-06-20 09:22:09,072] {standard_task_runner.py:52} INFO - Started process 123 to run task
[2021-06-20 09:22:09,077] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'orion', 'getInfoFromFiware', '2021-06-20T09:22:08.084474+00:00', '--job-id', '49', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/orion.py', '--cfg-path', '/tmp/tmpzbwes9f2', '--error-file', '/tmp/tmpu5a4h3_d']
[2021-06-20 09:22:09,078] {standard_task_runner.py:77} INFO - Job 49: Subtask getInfoFromFiware
[2021-06-20 09:22:09,127] {logging_mixin.py:104} INFO - Running <TaskInstance: orion.getInfoFromFiware 2021-06-20T09:22:08.084474+00:00 [running]> on host 438558517cf9
[2021-06-20 09:22:09,191] {taskinstance.py:1282} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=orion
AIRFLOW_CTX_TASK_ID=getInfoFromFiware
AIRFLOW_CTX_EXECUTION_DATE=2021-06-20T09:22:08.084474+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2021-06-20T09:22:08.084474+00:00
[2021-06-20 09:22:09,203] {logging_mixin.py:104} WARNING - --- Logging error ---
[2021-06-20 09:22:09,205] {logging_mixin.py:104} WARNING - Traceback (most recent call last):
[2021-06-20 09:22:09,205] {logging_mixin.py:104} WARNING -   File "/usr/local/lib/python3.6/logging/__init__.py", line 994, in emit
    msg = self.format(record)
[2021-06-20 09:22:09,206] {logging_mixin.py:104} WARNING -   File "/usr/local/lib/python3.6/logging/__init__.py", line 840, in format
    return fmt.format(record)
[2021-06-20 09:22:09,207] {logging_mixin.py:104} WARNING -   File "/usr/local/lib/python3.6/logging/__init__.py", line 577, in format
    record.message = record.getMessage()
[2021-06-20 09:22:09,207] {logging_mixin.py:104} WARNING -   File "/usr/local/lib/python3.6/logging/__init__.py", line 338, in getMessage
    msg = msg % self.args
[2021-06-20 09:22:09,208] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/models/xcom_arg.py", line 85, in __str__
    f"dag_id='{self.operator.dag.dag_id}'",
[2021-06-20 09:22:09,209] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/models/baseoperator.py", line 756, in dag
    raise AirflowException(f'Operator {self} has not been assigned to a DAG yet')
[2021-06-20 09:22:09,210] {logging_mixin.py:104} WARNING - ***.exceptions.AirflowException: Operator <Task(_PythonDecoratedOperator): getInfoFromFiware> has not been assigned to a DAG yet
[2021-06-20 09:22:09,210] {logging_mixin.py:104} WARNING - Call stack:
[2021-06-20 09:22:09,215] {logging_mixin.py:104} WARNING -   File "/home/***/.local/bin/***", line 8, in <module>
    sys.exit(main())
[2021-06-20 09:22:09,216] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/__main__.py", line 40, in main
    args.func(args)
[2021-06-20 09:22:09,216] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
[2021-06-20 09:22:09,217] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/utils/cli.py", line 91, in wrapper
    return f(*args, **kwargs)
[2021-06-20 09:22:09,218] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/commands/celery_command.py", line 176, in worker
    worker_instance.run(**options)
[2021-06-20 09:22:09,219] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/bin/worker.py", line 259, in run
    worker.start()
[2021-06-20 09:22:09,220] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/worker/worker.py", line 208, in start
    self.blueprint.start(self)
[2021-06-20 09:22:09,220] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/bootsteps.py", line 119, in start
    step.start(parent)
[2021-06-20 09:22:09,221] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/bootsteps.py", line 369, in start
    return self.obj.start()
[2021-06-20 09:22:09,222] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/concurrency/base.py", line 132, in start
    self.on_start()
[2021-06-20 09:22:09,223] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/concurrency/prefork.py", line 117, in on_start
    **self.options)
[2021-06-20 09:22:09,225] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/concurrency/asynpool.py", line 486, in __init__
    super(AsynPool, self).__init__(processes, *args, **kwargs)
[2021-06-20 09:22:09,225] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2021-06-20 09:22:09,227] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/concurrency/asynpool.py", line 503, in _create_worker_process
    return super(AsynPool, self)._create_worker_process(i)
[2021-06-20 09:22:09,227] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2021-06-20 09:22:09,228] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2021-06-20 09:22:09,229] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2021-06-20 09:22:09,230] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2021-06-20 09:22:09,230] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2021-06-20 09:22:09,231] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2021-06-20 09:22:09,232] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2021-06-20 09:22:09,233] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2021-06-20 09:22:09,233] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2021-06-20 09:22:09,234] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/app/trace.py", line 612, in _fast_trace_task
    uuid, args, kwargs, request,
[2021-06-20 09:22:09,235] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/app/trace.py", line 412, in trace_task
    R = retval = fun(*args, **kwargs)
[2021-06-20 09:22:09,236] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/celery/app/trace.py", line 704, in __protected_call__
    return self.run(*args, **kwargs)
[2021-06-20 09:22:09,237] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/executors/celery_executor.py", line 87, in execute_command
    _execute_in_fork(command_to_exec)
[2021-06-20 09:22:09,238] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/executors/celery_executor.py", line 116, in _execute_in_fork
    args.func(args)
[2021-06-20 09:22:09,238] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
[2021-06-20 09:22:09,242] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/utils/cli.py", line 91, in wrapper
    return f(*args, **kwargs)
[2021-06-20 09:22:09,243] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/commands/task_command.py", line 237, in task_run
    _run_task_by_selected_method(args, dag, ti)
[2021-06-20 09:22:09,244] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/commands/task_command.py", line 64, in _run_task_by_selected_method
    _run_task_by_local_task_job(args, ti)
[2021-06-20 09:22:09,244] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/commands/task_command.py", line 120, in _run_task_by_local_task_job
    run_job.run()
[2021-06-20 09:22:09,245] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/jobs/base_job.py", line 237, in run
    self._execute()
[2021-06-20 09:22:09,245] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/jobs/local_task_job.py", line 102, in _execute
    self.task_runner.start()
[2021-06-20 09:22:09,246] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/task/task_runner/standard_task_runner.py", line 41, in start
    self.process = self._start_by_fork()
[2021-06-20 09:22:09,247] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
[2021-06-20 09:22:09,247] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
[2021-06-20 09:22:09,248] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/utils/cli.py", line 91, in wrapper
    return f(*args, **kwargs)
[2021-06-20 09:22:09,249] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/commands/task_command.py", line 237, in task_run
    _run_task_by_selected_method(args, dag, ti)
[2021-06-20 09:22:09,249] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/commands/task_command.py", line 66, in _run_task_by_selected_method
    _run_raw_task(args, ti)
[2021-06-20 09:22:09,250] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/cli/commands/task_command.py", line 152, in _run_raw_task
    error_file=args.error_file,
[2021-06-20 09:22:09,250] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
[2021-06-20 09:22:09,251] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/models/taskinstance.py", line 1137, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
[2021-06-20 09:22:09,252] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/models/taskinstance.py", line 1311, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
[2021-06-20 09:22:09,252] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/models/taskinstance.py", line 1341, in _execute_task
    result = task_copy.execute(context=context)
[2021-06-20 09:22:09,254] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/operators/python.py", line 151, in execute
    self.log.info("Done. Returned value was: %s", return_value)
[2021-06-20 09:22:09,255] {logging_mixin.py:104} WARNING -   File "/usr/local/lib/python3.6/logging/__init__.py", line 1308, in info
    self._log(INFO, msg, args, **kwargs)
[2021-06-20 09:22:09,256] {logging_mixin.py:104} WARNING -   File "/usr/local/lib/python3.6/logging/__init__.py", line 1444, in _log
    self.handle(record)
[2021-06-20 09:22:09,257] {logging_mixin.py:104} WARNING -   File "/usr/local/lib/python3.6/logging/__init__.py", line 1454, in handle
    self.callHandlers(record)
[2021-06-20 09:22:09,258] {logging_mixin.py:104} WARNING -   File "/usr/local/lib/python3.6/logging/__init__.py", line 1516, in callHandlers
    hdlr.handle(record)
[2021-06-20 09:22:09,259] {logging_mixin.py:104} WARNING -   File "/usr/local/lib/python3.6/logging/__init__.py", line 865, in handle
    self.emit(record)
[2021-06-20 09:22:09,260] {logging_mixin.py:104} WARNING -   File "/home/***/.local/lib/python3.6/site-packages/***/utils/log/file_task_handler.py", line 64, in emit
    self.handler.emit(record)
[2021-06-20 09:22:09,260] {logging_mixin.py:104} WARNING - Message: 'Done. Returned value was: %s'
Arguments: (<***.models.xcom_arg.XComArg object at 0x7f8ed3c2a5f8>,)
[2021-06-20 09:22:09,261] {xcom.py:229} ERROR - Could not serialize the XCom value into JSON. If you are using pickle instead of JSON for XCom, then you need to enable pickle support for XCom in your *** config.
[2021-06-20 09:22:09,262] {taskinstance.py:1481} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1137, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1311, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1344, in _execute_task
    self.xcom_push(key=XCOM_RETURN_KEY, value=result)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1925, in xcom_push
    session=session,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/session.py", line 67, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/xcom.py", line 79, in set
    value = XCom.serialize_value(value)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/xcom.py", line 226, in serialize_value
    return json.dumps(value).encode('UTF-8')
  File "/usr/local/lib/python3.6/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/local/lib/python3.6/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.6/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/local/lib/python3.6/json/encoder.py", line 180, in default
    o.__class__.__name__)
TypeError: Object of type 'XComArg' is not JSON serializable
[2021-06-20 09:22:09,265] {taskinstance.py:1531} INFO - Marking task as FAILED. dag_id=orion, task_id=getInfoFromFiware, execution_date=20210620T092208, start_date=20210620T092209, end_date=20210620T092209
[2021-06-20 09:22:09,332] {local_task_job.py:151} INFO - Task exited with return code 1
